{"version":3,"sources":["query.js"],"names":["window","NS","resizeListeners","onResize","fn","doFirst","push","isRunning","args","requestAnimationFrame","throttle","document","addEventListener","l","passive","ua","navigator","userAgent","toLowerCase","includes","getBrowser","ret","length","getDevice","bpW","bpH","w","innerWidth","h","innerHeight","getBreakPointSize"],"mappings":"AAUAA,OAAM,MAAYA,OAAM,OAAa,GAGrC,SAAWC,GAiCV,MAAMC,EAAkB,GAExB,SAASC,EAASC,EAAIC,GAAU,GAC3BA,GAASD,IACbF,EAAgBI,KAhBjB,SAAkBF,GACjB,IAAIG,EACJ,MAAO,IAAIC,KACND,IACJA,GAAY,EACZE,uBAAsB,KACrBF,GAAY,EACZH,KAAMI,QASaE,CAASN,IAG/BO,SAASC,iBAAiB,oBAAoB,KAC7CZ,OAAOY,iBAAiB,UAAU,KACjC,IAAK,MAAMC,KAAKX,EAAiBW,MAC/B,CAAEC,SAAS,OAoHdb,EAAE,QArCF,WACC,MAAMc,EAAKf,OAAOgB,UAAUC,UAAUC,cACtC,OAAIH,EAAGI,SAAS,UACR,SAEJJ,EAAGI,SAAS,UACR,SAEJJ,EAAGI,SAAS,WACR,eADR,EA6BeC,GAChBnB,EAAE,OAzBF,WACC,MAAMc,EAAKf,OAAOgB,UAAUC,UAAUC,cAEhCG,EAAM,GAkBZ,OAjBIN,EAAGI,SAAS,YACfE,EAAIf,KAAK,WAENS,EAAGI,SAAS,WACfE,EAAIf,KAAK,OACTe,EAAIf,KAAK,WACCS,EAAGI,SAAS,SACtBE,EAAIf,KAAK,OACTe,EAAIf,KAAK,SACCS,EAAGI,SAAS,YAAcJ,EAAGI,SAAS,WAAa,eAAgBR,WAC7EU,EAAIf,KAAK,OACTe,EAAIf,KAAK,QACTe,EAAIf,KAAK,iBAELe,EAAIC,QACRD,EAAIf,KAAK,WAEHe,EAIOE,GAEfpB,GAAS,MACPF,EAAE,SAAcA,EAAE,WA3EpB,WACC,IAAIuB,EAAKC,EAET,MAAMC,EAAI1B,OAAO2B,WAEhBH,EADGE,EAAI,IACD,iBACIA,EAAI,IACR,kBACIA,EAAI,IACR,kBACIA,EAAI,KACR,mBACIA,EAAI,KACR,UAEA,cAEP,MAAME,EAAI5B,OAAO6B,YAUjB,OARCJ,EADGG,EAAI,IACD,OACIA,EAAI,IACR,QACIA,EAAI,IACR,SAEA,QAEA,CAACJ,EAAKC,GAgDuBK,MAClC,GApKL,CAuKG9B,OAAM","file":"query.min.js","sourcesContent":["/**\n *\n * Query\n *\n * @author Takuto Yanagida\n * @version 2021-11-25\n *\n */\n\n\nwindow['NACSS'] = window['NACSS'] || {};\n\n\n(function (NS) {\n\n\t/**\n\t *\n\t * Utilities\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-11-17\n\t *\n\t */\n\t\n\t\n\tfunction getScrollOffset() {\n\t\tconst s = getComputedStyle(document.documentElement);\n\t\treturn parseInt(s.scrollPaddingTop);\n\t}\n\t\n\t\n\t// -----------------------------------------------------------------------------\n\t\n\t\n\tfunction throttle(fn) {\n\t\tlet isRunning;\n\t\treturn (...args) => {\n\t\t\tif (isRunning) return;\n\t\t\tisRunning = true;\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tisRunning = false;\n\t\t\t\tfn(...args);\n\t\t\t});\n\t\t};\n\t}\n\t\n\tconst resizeListeners = [];\n\t\n\tfunction onResize(fn, doFirst = false) {\n\t\tif (doFirst) fn();\n\t\tresizeListeners.push(throttle(fn));\n\t}\n\t\n\tdocument.addEventListener('DOMContentLoaded', () => {\n\t\twindow.addEventListener('resize', () => {\n\t\t\tfor (const l of resizeListeners) l();\n\t\t}, { passive: true });\n\t});\n\t\n\t\n\t// -----------------------------------------------------------------------------\n\t\n\t\n\tfunction onIntersect(fn, targets, threshold = 0, rootMargin ='* 0px 0px 0px') {\n\t\tconst vs = Array(targets.length).fill(false);\n\t\tconst tm = new Map();\n\t\ttargets.forEach((t, i) => tm.set(t, i));\n\t\n\t\tfunction init() {\n\t\t\tconst io = new IntersectionObserver((es) => {\n\t\t\t\tfor (const e of es) vs[tm.get(e.target)] = e.isIntersecting;\n\t\t\t\tfn(vs);\n\t\t\t}, { rootMargin: rootMargin.replace('*', `${mt}px`), threshold });\n\t\t\tfor (const t of targets) io.observe(t);\n\t\t\treturn io;\n\t\t}\n\t\tlet mt = 0;\n\t\tlet io = null;\n\t\tlet st = null;\n\t\tonResize(() => {\n\t\t\tmt = -getScrollOffset();\n\t\t\tif (st) clearTimeout(st);\n\t\t\tst = setTimeout(() => {\n\t\t\t\tif (io) io.disconnect();\n\t\t\t\tio = init();\n\t\t\t}, 100);\n\t\t}, true);\n\t}\n\t\n\n\t(function () {\n\t\t/**\n\t\t *\n\t\t * Inner\n\t\t *\n\t\t * @author Takuto Yanagida\n\t\t * @version 2021-11-25\n\t\t *\n\t\t */\n\t\t\n\t\t\n\t\tfunction getBreakPointSize() {\n\t\t\tlet bpW, bpH;\n\t\t\n\t\t\tconst w = window.innerWidth;\n\t\t\tif (w < 450) {\n\t\t\t\tbpW = 'phone-portrait';\n\t\t\t} else if (w < 600) {\n\t\t\t\tbpW = 'phone-landscape';\n\t\t\t} else if (w < 900) {\n\t\t\t\tbpW = 'tablet-portrait';\n\t\t\t} else if (w < 1200) {\n\t\t\t\tbpW = 'tablet-landscape';\n\t\t\t} else if (w < 1500) {\n\t\t\t\tbpW = 'desktop';\n\t\t\t} else {\n\t\t\t\tbpW = 'big-desktop';\n\t\t\t}\n\t\t\tconst h = window.innerHeight;\n\t\t\tif (h < 700) {\n\t\t\t\tbpH = 'tiny';\n\t\t\t} else if (h < 800) {\n\t\t\t\tbpH = 'small';\n\t\t\t} else if (h < 900) {\n\t\t\t\tbpH = 'medium';\n\t\t\t} else {\n\t\t\t\tbpH = 'large';\n\t\t\t}\n\t\t\treturn [bpW, bpH];\n\t\t}\n\t\t\n\t\t\n\t\t// -----------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction getBrowser() {\n\t\t\tconst ua = window.navigator.userAgent.toLowerCase();\n\t\t\tif (ua.includes('chrome')) {  // UA includes 'safari'.\n\t\t\t\treturn 'chrome';\n\t\t\t}\n\t\t\tif (ua.includes('safari')) {\n\t\t\t\treturn 'safari';\n\t\t\t}\n\t\t\tif (ua.includes('firefox')) {\n\t\t\t\treturn 'firefox';\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction getDevice() {\n\t\t\tconst ua = window.navigator.userAgent.toLowerCase();\n\t\t\n\t\t\tconst ret = [];\n\t\t\tif (ua.includes('android')) {\n\t\t\t\tret.push('android');\n\t\t\t}\n\t\t\tif (ua.includes('iphone')) {\n\t\t\t\tret.push('ios');\n\t\t\t\tret.push('iphone');\n\t\t\t} else if (ua.includes('ipad')) {\n\t\t\t\tret.push('ios');\n\t\t\t\tret.push('ipad');\n\t\t\t} else if (ua.includes('safari') && !ua.includes('chrome') && 'ontouchend' in document) {\n\t\t\t\tret.push('ios');\n\t\t\t\tret.push('ipad');\n\t\t\t\tret.push('ipad-desktop');\n\t\t\t}\n\t\t\tif (!ret.length) {\n\t\t\t\tret.push('desktop');\n\t\t\t}\n\t\t\treturn ret;\n\t\t}\n\t\t\n\t\tNS['BROWSER'] = getBrowser();\n\t\tNS['DEVICE'] = getDevice();\n\n\t\tonResize(() => {\n\t\t\t[NS['BP_WIDTH'], NS['BP_HEIGHT']] = getBreakPointSize();\n\t\t}, true);\n\t})();\n\n})(window['NACSS']);\n"]}