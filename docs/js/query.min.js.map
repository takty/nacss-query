{"version":3,"sources":["query.js"],"names":["window","NS","resizeListeners","onResize","fn","doFirst","push","isRunning","args","requestAnimationFrame","throttle","document","addEventListener","l","passive","getBreakPointSize","bpW","bpH","w","innerWidth","h","innerHeight","getBrowser","ua","navigator","userAgent","toLowerCase","includes","getDevice","ret","length"],"mappings":"AAUA,aAEAA,OAAM,MAAYA,OAAM,OAAa,GAGrC,SAAWC,GAkCV,MAAMC,EAAkB,GAExB,SAASC,EAASC,EAAIC,GAAU,GAC3BA,GAASD,IACbF,EAAgBI,KAhBjB,SAAkBF,GACjB,IAAIG,EACJ,MAAO,IAAIC,KACND,IACJA,GAAY,EACZE,uBAAsB,KACrBF,GAAY,EACZH,KAAMI,QASaE,CAASN,IAG/BO,SAASC,iBAAiB,oBAAoB,KAC7CZ,OAAOY,iBAAiB,UAAU,KACjC,IAAK,MAAMC,KAAKX,EAAiBW,MAC/B,CAAEC,SAAS,OAkCf,CAWC,SAASC,IACR,IAAIC,EAAKC,EAET,MAAMC,EAAIlB,OAAOmB,WAEhBH,EADGE,EAAI,IACD,iBACIA,EAAI,IACR,kBACIA,EAAI,IACR,kBACIA,EAAI,KACR,mBACIA,EAAI,KACR,UAEA,cAEP,MAAME,EAAIpB,OAAOqB,YAUjB,OARCJ,EADGG,EAAI,IACD,OACIA,EAAI,IACR,QACIA,EAAI,IACR,SAEA,QAEA,CAACJ,EAAKC,GAOd,SAASK,IACR,MAAMC,EAAKvB,OAAOwB,UAAUC,UAAUC,cACtC,OAAIH,EAAGI,SAAS,UACR,SAEJJ,EAAGI,SAAS,UACR,SAEJJ,EAAGI,SAAS,WACR,eADR,EAKD,SAASC,IACR,MAAML,EAAKvB,OAAOwB,UAAUC,UAAUC,cAEhCG,EAAM,GAkBZ,OAjBIN,EAAGI,SAAS,YACfE,EAAIvB,KAAK,WAENiB,EAAGI,SAAS,WACfE,EAAIvB,KAAK,OACTuB,EAAIvB,KAAK,WACCiB,EAAGI,SAAS,SACtBE,EAAIvB,KAAK,OACTuB,EAAIvB,KAAK,SACCiB,EAAGI,SAAS,YAAcJ,EAAGI,SAAS,WAAa,eAAgBhB,WAC7EkB,EAAIvB,KAAK,OACTuB,EAAIvB,KAAK,QACTuB,EAAIvB,KAAK,iBAELuB,EAAIC,QACRD,EAAIvB,KAAK,WAEHuB,EAGR5B,EAAE,QAAcqB,IAChBrB,EAAE,OAAa2B,IAEfzB,GAAS,MACPF,EAAE,SAAcA,EAAE,WAAiBc,OAClC,IArKL,CAwKGf,OAAM","file":"query.min.js","sourcesContent":["/**\n *\n * Query\n *\n * @author Takuto Yanagida\n * @version 2021-12-07\n *\n */\n\n\n'use strict';\n\nwindow['NACSS'] = window['NACSS'] || {};\n\n\n(function (NS) {\n\n\t/**\n\t *\n\t * Utilities\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2021-12-06\n\t *\n\t */\n\t\n\t\n\tfunction getScrollOffset() {\n\t\tconst s   = getComputedStyle(document.documentElement);\n\t\tconst val = parseInt(s.scrollPaddingTop);\n\t\treturn Number.isNaN(val) ? 0 : val;\n\t}\n\t\n\t\n\t// -----------------------------------------------------------------------------\n\t\n\t\n\tfunction throttle(fn) {\n\t\tlet isRunning;\n\t\treturn (...args) => {\n\t\t\tif (isRunning) return;\n\t\t\tisRunning = true;\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tisRunning = false;\n\t\t\t\tfn(...args);\n\t\t\t});\n\t\t};\n\t}\n\t\n\tconst resizeListeners = [];\n\t\n\tfunction onResize(fn, doFirst = false) {\n\t\tif (doFirst) fn();\n\t\tresizeListeners.push(throttle(fn));\n\t}\n\t\n\tdocument.addEventListener('DOMContentLoaded', () => {\n\t\twindow.addEventListener('resize', () => {\n\t\t\tfor (const l of resizeListeners) l();\n\t\t}, { passive: true });\n\t});\n\t\n\t\n\t// -----------------------------------------------------------------------------\n\t\n\t\n\tfunction onIntersect(fn, targets, threshold = 0, rootMargin ='* 0px 0px 0px') {\n\t\tconst vs = Array(targets.length).fill(false);\n\t\tconst tm = new Map();\n\t\ttargets.forEach((t, i) => tm.set(t, i));\n\t\n\t\tfunction init() {\n\t\t\tconst io = new IntersectionObserver((es) => {\n\t\t\t\tfor (const e of es) vs[tm.get(e.target)] = e.isIntersecting;\n\t\t\t\tfn(vs);\n\t\t\t}, { rootMargin: rootMargin.replace('*', `${mt}px`), threshold });\n\t\t\tfor (const t of targets) io.observe(t);\n\t\t\treturn io;\n\t\t}\n\t\tlet mt = 0;\n\t\tlet io = null;\n\t\tlet st = null;\n\t\tonResize(() => {\n\t\t\tmt = -getScrollOffset();\n\t\t\tif (st) clearTimeout(st);\n\t\t\tst = setTimeout(() => {\n\t\t\t\tif (io) io.disconnect();\n\t\t\t\tio = init();\n\t\t\t}, 100);\n\t\t}, true);\n\t}\n\t\n\n\t{\n\t\t/**\n\t\t *\n\t\t * Inner\n\t\t *\n\t\t * @author Takuto Yanagida\n\t\t * @version 2021-11-25\n\t\t *\n\t\t */\n\t\t\n\t\t\n\t\tfunction getBreakPointSize() {\n\t\t\tlet bpW, bpH;\n\t\t\n\t\t\tconst w = window.innerWidth;\n\t\t\tif (w < 450) {\n\t\t\t\tbpW = 'phone-portrait';\n\t\t\t} else if (w < 600) {\n\t\t\t\tbpW = 'phone-landscape';\n\t\t\t} else if (w < 900) {\n\t\t\t\tbpW = 'tablet-portrait';\n\t\t\t} else if (w < 1200) {\n\t\t\t\tbpW = 'tablet-landscape';\n\t\t\t} else if (w < 1500) {\n\t\t\t\tbpW = 'desktop';\n\t\t\t} else {\n\t\t\t\tbpW = 'big-desktop';\n\t\t\t}\n\t\t\tconst h = window.innerHeight;\n\t\t\tif (h < 700) {\n\t\t\t\tbpH = 'tiny';\n\t\t\t} else if (h < 800) {\n\t\t\t\tbpH = 'small';\n\t\t\t} else if (h < 900) {\n\t\t\t\tbpH = 'medium';\n\t\t\t} else {\n\t\t\t\tbpH = 'large';\n\t\t\t}\n\t\t\treturn [bpW, bpH];\n\t\t}\n\t\t\n\t\t\n\t\t// -----------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction getBrowser() {\n\t\t\tconst ua = window.navigator.userAgent.toLowerCase();\n\t\t\tif (ua.includes('chrome')) {  // UA includes 'safari'.\n\t\t\t\treturn 'chrome';\n\t\t\t}\n\t\t\tif (ua.includes('safari')) {\n\t\t\t\treturn 'safari';\n\t\t\t}\n\t\t\tif (ua.includes('firefox')) {\n\t\t\t\treturn 'firefox';\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction getDevice() {\n\t\t\tconst ua = window.navigator.userAgent.toLowerCase();\n\t\t\n\t\t\tconst ret = [];\n\t\t\tif (ua.includes('android')) {\n\t\t\t\tret.push('android');\n\t\t\t}\n\t\t\tif (ua.includes('iphone')) {\n\t\t\t\tret.push('ios');\n\t\t\t\tret.push('iphone');\n\t\t\t} else if (ua.includes('ipad')) {\n\t\t\t\tret.push('ios');\n\t\t\t\tret.push('ipad');\n\t\t\t} else if (ua.includes('safari') && !ua.includes('chrome') && 'ontouchend' in document) {\n\t\t\t\tret.push('ios');\n\t\t\t\tret.push('ipad');\n\t\t\t\tret.push('ipad-desktop');\n\t\t\t}\n\t\t\tif (!ret.length) {\n\t\t\t\tret.push('desktop');\n\t\t\t}\n\t\t\treturn ret;\n\t\t}\n\t\t\n\t\tNS['BROWSER'] = getBrowser();\n\t\tNS['DEVICE'] = getDevice();\n\n\t\tonResize(() => {\n\t\t\t[NS['BP_WIDTH'], NS['BP_HEIGHT']] = getBreakPointSize();\n\t\t}, true);\n\t}\n\n})(window['NACSS']);\n"]}