{"version":3,"sources":["utility.js"],"names":["window","NS","onLoad","fn","document","readyState","addEventListener","setTimeout","resizeListeners","onResize","doFirst","push","isRunning","args","requestAnimationFrame","throttle","l","passive","getBreakPointSize","bpW","bpH","w","innerWidth","h","innerHeight","getBrowser","ua","navigator","userAgent","toLowerCase","includes","getDevice","ret","length","setClass","tar","cls","enabled","val","key","substr","startsWith","dataset","c","join","classList","add","remove","apply","opts","elm","ts","querySelectorAll","styleKey","replace","charAt","t","children","firstChild","removeChild","Object","assign","root","body","MutationObserver","ms","m","type","target","observe","childList","applyBlank","ro","ResizeObserver","es","e","calc","box","q","qss","split","map","trim","cp","ep","isNaN","style","setProperty","console","log","applyDimension"],"mappings":"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","file":"utility.min.js","sourcesContent":["/**\n * Utility\n *\n * @author Takuto Yanagida\n * @version 2023-02-01\n */\n\n'use strict';\n\nwindow['NACSS']            = window['NACSS'] || {};\nwindow['NACSS']['utility'] = window['NACSS']['utility'] || {};\n\n(NS => {\n\n\t/**\n\t * Utilities\n\t *\n\t * @author Takuto Yanagida\n\t * @version 2023-02-01\n\t */\n\t\n\tfunction getScrollOffset() {\n\t\tconst s   = getComputedStyle(document.documentElement);\n\t\tconst val = parseInt(s.scrollPaddingTop);\n\t\treturn Number.isNaN(val) ? 0 : val;\n\t}\n\t\n\tfunction onLoad(fn) {\n\t\tif ('loading' === document.readyState) {\n\t\t\tdocument.addEventListener('DOMContentLoaded', fn);\n\t\t} else {\n\t\t\tsetTimeout(fn, 0);\n\t\t}\n\t}\n\t\n\t\n\t// -----------------------------------------------------------------------------\n\t\n\t\n\tfunction throttle(fn) {\n\t\tlet isRunning;\n\t\treturn (...args) => {\n\t\t\tif (isRunning) return;\n\t\t\tisRunning = true;\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tisRunning = false;\n\t\t\t\tfn(...args);\n\t\t\t});\n\t\t};\n\t}\n\t\n\tconst resizeListeners = [];\n\t\n\tfunction onResize(fn, doFirst = false) {\n\t\tif (doFirst) fn();\n\t\tresizeListeners.push(throttle(fn));\n\t}\n\t\n\tdocument.addEventListener('DOMContentLoaded', () => {\n\t\twindow.addEventListener('resize', () => {\n\t\t\tfor (const l of resizeListeners) l();\n\t\t}, { passive: true });\n\t});\n\t\n\t\n\t// -----------------------------------------------------------------------------\n\t\n\t\n\tfunction onIntersect(fn, targets, threshold = 0, rootMargin ='* 0px 0px 0px') {\n\t\tconst vs = Array(targets.length).fill(false);\n\t\tconst tm = new Map();\n\t\ttargets.forEach((t, i) => tm.set(t, i));\n\t\n\t\tfunction init() {\n\t\t\tconst io = new IntersectionObserver((es) => {\n\t\t\t\tfor (const e of es) vs[tm.get(e.target)] = e.isIntersecting;\n\t\t\t\tfn(vs);\n\t\t\t}, { rootMargin: rootMargin.replace('*', `${mt}px`), threshold });\n\t\t\tfor (const t of targets) io.observe(t);\n\t\t\treturn io;\n\t\t}\n\t\tlet mt = 0;\n\t\tlet io = null;\n\t\tlet st = null;\n\t\tonResize(() => {\n\t\t\tmt = -getScrollOffset();\n\t\t\tif (st) clearTimeout(st);\n\t\t\tst = setTimeout(() => {\n\t\t\t\tif (io) io.disconnect();\n\t\t\t\tio = init();\n\t\t\t}, 100);\n\t\t}, true);\n\t}\n\t\n\t{\n\t\t/**\n\t\t * Inner\n\t\t *\n\t\t * @author Takuto Yanagida\n\t\t * @version 2021-11-25\n\t\t */\n\t\t\n\t\tfunction getBreakPointSize() {\n\t\t\tlet bpW, bpH;\n\t\t\n\t\t\tconst w = window.innerWidth;\n\t\t\tif (w < 450) {\n\t\t\t\tbpW = 'phone-portrait';\n\t\t\t} else if (w < 600) {\n\t\t\t\tbpW = 'phone-landscape';\n\t\t\t} else if (w < 900) {\n\t\t\t\tbpW = 'tablet-portrait';\n\t\t\t} else if (w < 1200) {\n\t\t\t\tbpW = 'tablet-landscape';\n\t\t\t} else if (w < 1500) {\n\t\t\t\tbpW = 'desktop';\n\t\t\t} else {\n\t\t\t\tbpW = 'big-desktop';\n\t\t\t}\n\t\t\tconst h = window.innerHeight;\n\t\t\tif (h < 700) {\n\t\t\t\tbpH = 'tiny';\n\t\t\t} else if (h < 800) {\n\t\t\t\tbpH = 'small';\n\t\t\t} else if (h < 900) {\n\t\t\t\tbpH = 'medium';\n\t\t\t} else {\n\t\t\t\tbpH = 'large';\n\t\t\t}\n\t\t\treturn [bpW, bpH];\n\t\t}\n\t\t\n\t\t\n\t\t// -----------------------------------------------------------------------------\n\t\t\n\t\t\n\t\tfunction getBrowser() {\n\t\t\tconst ua = window.navigator.userAgent.toLowerCase();\n\t\t\tif (ua.includes('chrome')) {  // UA includes 'safari'.\n\t\t\t\treturn 'chrome';\n\t\t\t}\n\t\t\tif (ua.includes('safari')) {\n\t\t\t\treturn 'safari';\n\t\t\t}\n\t\t\tif (ua.includes('firefox')) {\n\t\t\t\treturn 'firefox';\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction getDevice() {\n\t\t\tconst ua = window.navigator.userAgent.toLowerCase();\n\t\t\n\t\t\tconst ret = [];\n\t\t\tif (ua.includes('android')) {\n\t\t\t\tret.push('android');\n\t\t\t}\n\t\t\tif (ua.includes('iphone')) {\n\t\t\t\tret.push('ios');\n\t\t\t\tret.push('iphone');\n\t\t\t} else if (ua.includes('ipad')) {\n\t\t\t\tret.push('ios');\n\t\t\t\tret.push('ipad');\n\t\t\t} else if (ua.includes('safari') && !ua.includes('chrome') && 'ontouchend' in document) {\n\t\t\t\tret.push('ios');\n\t\t\t\tret.push('ipad');\n\t\t\t\tret.push('ipad-desktop');\n\t\t\t}\n\t\t\tif (!ret.length) {\n\t\t\t\tret.push('desktop');\n\t\t\t}\n\t\t\treturn ret;\n\t\t}\n\t\t\n\t\tNS['BROWSER'] = getBrowser();\n\t\tNS['DEVICE']  = getDevice();\n\n\t\tonResize(() => {\n\t\t\t[NS['BP_WIDTH'], NS['BP_HEIGHT']] = getBreakPointSize();\n\t\t}, true);\n\t}\n\n\t(NS => {\n\n\t\t/**\n\t\t * Style Class Utilities\n\t\t *\n\t\t * @author Takuto Yanagida\n\t\t * @version 2021-11-11\n\t\t */\n\t\t\n\t\tfunction hasClass(tar, cls) {\n\t\t\tconst key = cls.substr(1);\n\t\t\tif (cls.startsWith(':')) {\n\t\t\t\treturn tar.dataset[key] !== undefined;\n\t\t\t} else {\n\t\t\t\treturn tar.classList.contains(key);\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction setClass(tar, cls, enabled = true, val = '') {\n\t\t\tconst key = cls.substr(1);\n\t\t\tif (cls.startsWith(':')) {\n\t\t\t\tif (enabled) {\n\t\t\t\t\ttar.dataset[key] = val;\n\t\t\t\t} else {\n\t\t\t\t\tdelete tar.dataset[key];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst c = [key, val].join('-');\n\t\t\t\tif (enabled) {\n\t\t\t\t\ttar.classList.add(c);\n\t\t\t\t} else {\n\t\t\t\t\ttar.classList.remove(c);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction getSelector(cls) {\n\t\t\tif (cls.startsWith(':')) {\n\t\t\t\treturn `*[data-${cls.substr(1).replace(/([A-Z])/g, c => '-' + c.charAt(0).toLowerCase())}]`;\n\t\t\t} else {\n\t\t\t\treturn `*${cls}`;\n\t\t\t}\n\t\t}\n\t\t\n\t\t{\n\t\t\t/**\n\t\t\t * Polyfill of pseudo class 'blank'\n\t\t\t *\n\t\t\t * @author Takuto Yanagida\n\t\t\t * @version 2023-02-01\n\t\t\t */\n\t\t\t\n\t\t\tfunction apply(opts = {}) {\n\t\t\t\topts = Object.assign({\n\t\t\t\t\troot    : document.body,\n\t\t\t\t\tstyleKey: ':ncBlank',\n\t\t\t\t}, opts);\n\t\t\t\n\t\t\t\tonLoad(() => {\n\t\t\t\t\tapply(opts.root);\n\t\t\t\t\tconst mo = new MutationObserver(ms => {\n\t\t\t\t\t\tfor (const m of ms) {\n\t\t\t\t\t\t\tif ('childList' === m.type) apply(m.target);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tmo.observe(opts.root, { childList: true });\n\t\t\t\t});\n\t\t\t\n\t\t\t\tfunction apply(elm) {\n\t\t\t\t\tconst ts = elm.querySelectorAll(getSelector(opts.styleKey));\n\t\t\t\t\tfor (const t of ts) {\n\t\t\t\t\t\tif (!t.children.length) {\n\t\t\t\t\t\t\twhile (t.firstChild) t.removeChild(t.firstChild);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetClass(t, opts.styleKey, false)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tNS.applyBlank = apply;\n\t\t}\n\t\t{\n\t\t\t/**\n\t\t\t * Custom property of element dimensions\n\t\t\t *\n\t\t\t * @author Takuto Yanagida\n\t\t\t * @version 2023-02-01\n\t\t\t */\n\t\t\t\n\t\t\tfunction apply(opts = {}) {\n\t\t\t\topts = Object.assign({\n\t\t\t\t\troot: document.body,\n\t\t\t\t\tkey : 'ncDim',\n\t\t\t\t}, opts);\n\t\t\t\n\t\t\t\tconst ro = new ResizeObserver(es => {\n\t\t\t\t\tfor (const e of es) {\n\t\t\t\t\t\tcalc(e.target);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\n\t\t\t\tonLoad(() => {\n\t\t\t\t\tadd(opts.root);\n\t\t\t\n\t\t\t\t\tconst mo = new MutationObserver(es => {\n\t\t\t\t\t\tfor (const e of es) {\n\t\t\t\t\t\t\tif ('childList' === e.type) {\n\t\t\t\t\t\t\t\tadd(e.target);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tmo.observe(opts.root, { childList: true });\n\t\t\t\t});\n\t\t\t\n\t\t\t\tfunction add(root) {\n\t\t\t\t\tif (root.dataset[opts.key]) {\n\t\t\t\t\t\tro.observe(root, { box: 'border-box' });\n\t\t\t\t\t}\n\t\t\t\t\tconst ts = root.querySelectorAll(`*[data-${opts.key.replace(/([A-Z])/g, c => '-' + c.charAt(0).toLowerCase())}]`);\n\t\t\t\t\tfor (const t of ts) {\n\t\t\t\t\t\tro.observe(t, { box: 'border-box' });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\n\t\t\t\tfunction calc(elm) {\n\t\t\t\t\tconst q = elm.dataset[opts.key];\n\t\t\t\t\tif (!q) return;\n\t\t\t\n\t\t\t\t\tconst qs  = q.split(';').map(e => e.trim());\n\t\t\t\t\tconst qss = qs.map(e => e.split(':').map(e => e.trim()));\n\t\t\t\n\t\t\t\t\tfor (let [cp, ep] of qss) {\n\t\t\t\t\t\tif (!cp.startsWith('--')) {\n\t\t\t\t\t\t\tcp = '--' + cp;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (ep in elm && !isNaN(elm[ep])) {\n\t\t\t\t\t\t\topts.root.style.setProperty(cp, elm[ep] + 'px');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (!(ep in elm)) {\n\t\t\t\t\t\t\t\tconsole.log(`nacss.utility.dimension: property '${ep}' does not exists in the element`);\n\t\t\t\t\t\t\t} else if (isNaN(elm[ep])) {\n\t\t\t\t\t\t\t\tconsole.log(`nacss.utility.dimension: property '${ep}' is not a number`);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tNS.applyDimension = apply;\n\t\t}\n\n\t})(NS['utility']);\n\n})(window['NACSS']);\n"]}